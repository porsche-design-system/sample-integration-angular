!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=o(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function o(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */l=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(T){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),a=new x(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return S()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=c;var h={};function p(){}function f(){}function d(){}var v={};s(v,o,function(){return this});var g=Object.getPrototypeOf,y=g&&g(g(E([])));y&&y!==t&&n.call(y,o)&&(v=y);var m=d.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function _(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then(function(e){r("next",e,a,s)},function(e){r("throw",e,a,s)}):t.resolve(h).then(function(e){l.value=e,a(l)},function(e){return r("throw",e,a,s)})}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t(function(t,o){r(e,n,t,o)})}return o=o?o.then(i,i):i()}}function k(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,h;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=d,s(m,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},w(_.prototype),s(_.prototype,i,function(){return this}),e.AsyncIterator=_,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new _(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(m),s(m,a,"Generator"),s(m,o,function(){return this}),s(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=E,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}(self.webpackChunksample_integration_angular=self.webpackChunksample_integration_angular||[]).push([[754],{3754:function(t,o,a){a.r(o),a.d(o,{phn_header:function(){return se}});var c=a(8239),h=a(5346),p=a(8605),f=a(7321),d=a(6632),v=a(4195),g=a(9035),y=a(6202),m=a(5514),w=a(6967),_=a(2391),k=a(7493),b=a(1628);a(4413);var R,x,E={test:{CONTENT_URL:"http://content/url",ASSETS_URL:"http://assets/url",PROFILE_API_URL:"http://profile-api/url",FOOTER_ASSETS_URL:"http://footer/assets",COUNTRY_SELECTOR_URL:"http://select/countries",UNREAD_MESSAGES_COUNT_API_URL:"http://unread-messages-count-api/url",LOGIN_BASE_URL:"http://login-base/url",LOGIN_REDIRECT_URL:"http://login-redirect/url",CLIENT_ID:"client-id",PORSCHE_COM_URL:["http://porsche-com/url"],DEALER_API_URL:"https://configurator-dev.porsche.com/api/dealer-search/dealers"},local:{CONTENT_URL:"https://preview-nav.porsche.com/content",ASSETS_URL:".",FOOTER_ASSETS_URL:"https://footer.pchomenav.aws.porsche.cloud/assets",COUNTRY_SELECTOR_URL:"https://preview.ppn.porsche.com/countries",PROFILE_API_URL:"https://api.porsche-preview.com/profiles/mydata",UNREAD_MESSAGES_COUNT_API_URL:"https://api.porsche-preview.com/inbox/pp/rest/messages/unreadCount",LOGIN_BASE_URL:"https://preview-login.porsche.com",LOGIN_REDIRECT_URL:"https://preview-nav.porsche.com/authIframe.html",CLIENT_ID:"V5yfGusXVALiypCMRFBfM4IAHaZ0IA4A",PORSCHE_COM_URL:["http://localhost:3333","http://localhost:3334","http://localhost:3335"],DEALER_API_URL:"https://configurator-dev.porsche.com/api/dealer-search/dealers"},preview:{CONTENT_URL:"https://preview-nav.porsche.com/content",ASSETS_URL:"https://preview-nav.porsche.com",FOOTER_ASSETS_URL:"https://footer.pchomenav.aws.porsche.cloud/assets",COUNTRY_SELECTOR_URL:"https://preview.ppn.porsche.com/countries",PROFILE_API_URL:"https://api.porsche-preview.com/profiles/mydata",UNREAD_MESSAGES_COUNT_API_URL:"https://api.porsche-preview.com/inbox/pp/rest/messages/unreadCount",LOGIN_BASE_URL:"https://preview-login.porsche.com",LOGIN_REDIRECT_URL:"https://preview-nav.porsche.com/authIframe.html",CLIENT_ID:"V5yfGusXVALiypCMRFBfM4IAHaZ0IA4A",PORSCHE_COM_URL:["https://vanillajs.preview-nav.porsche.com","https://angular.preview-nav.porsche.com","https://react.preview-nav.porsche.com","https://vanillajs.pchomenav.aws.porsche.cloud","https://react.pchomenav.aws.porsche.cloud","https://angular.pchomenav.aws.porsche.cloud","https://preview.ppn.porsche.com"],DEALER_API_URL:""},production:{CONTENT_URL:"https://nav.porsche.com/00BC524/content",ASSETS_URL:"https://nav.porsche.com/00BC524",FOOTER_ASSETS_URL:"https://nav.porsche.com/00BC524/footer/assets",PROFILE_API_URL:"https://api.porsche.com/profiles/mydata",COUNTRY_SELECTOR_URL:"https://porsche.com/countries",UNREAD_MESSAGES_COUNT_API_URL:"https://api.porsche.com/inbox/p/rest/messages/unreadCount",LOGIN_BASE_URL:"https://login.porsche.com",LOGIN_REDIRECT_URL:"https://nav.porsche.com/00BC524/auth/authIframe.html",CLIENT_ID:"QPw3VOLAMfI7r0nmRY8ELq4RzZpZeXEE",PORSCHE_COM_URL:["https://www.porsche.com"],DEALER_API_URL:""}},S=(R=(0,c.Z)(l().mark(function e(t,n){var r,o,i,a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=(0,f.s)(n),i=o.country,a=o.language,e.next=4,fetch("".concat(t,"/").concat(a,"-").concat(i,".json"),{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}});case 4:r=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),(0,d.e)("content","Failed to fetch content with error: ".concat(e.t0)),e.t0;case 10:if(404!==r.status){e.next=12;break}throw new Error("No content for locale ".concat(n," found"));case 12:if(r.ok){e.next=14;break}throw new Error("Could not get content for locale ".concat(n));case 14:return e.abrupt("return",r.json());case 15:case"end":return e.stop()}},e,null,[[0,7]])})),function(e,t){return R.apply(this,arguments)}),T=function(t){i(a,t);var o=s(a);function a(t){var n;return e(this,a),(n=o.call(this,t)).context.eventAction="PAGHomeNav_General_Load",n}return n(a,[{key:"event",value:function(){return r(u(a.prototype),"event",this).call(this)}}]),a}(v.L),L=new Uint8Array(16);function A(){if(!x&&!(x="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(L)}var C=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function O(e){return"string"==typeof e&&C.test(e)}for(var I=[],U=0;U<256;++U)I.push((U+256).toString(16).substr(1));function P(e,t,n){var r=(e=e||{}).random||(e.rng||A)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(I[e[t+0]]+I[e[t+1]]+I[e[t+2]]+I[e[t+3]]+"-"+I[e[t+4]]+I[e[t+5]]+"-"+I[e[t+6]]+I[e[t+7]]+"-"+I[e[t+8]]+I[e[t+9]]+"-"+I[e[t+10]]+I[e[t+11]]+I[e[t+12]]+I[e[t+13]]+I[e[t+14]]+I[e[t+15]]).toLowerCase();if(!O(n))throw TypeError("Stringified UUID is invalid");return n}(r)}for(var N=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AppAuthError=void 0,t.AppAuthError=function(e,t){this.message=e,this.extras=t}}),j=(0,w.c)(function(e,t){var n,r=w.a&&w.a.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.TestRequestor=t.FetchRequestor=t.JQueryRequestor=t.Requestor=void 0;var o=function(){};t.Requestor=o;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.xhr=function(e){var t=$.ajax(e);return new Promise(function(e,n){t.then(function(t,n,r){e(t)},function(e,t,r){n(new N.AppAuthError(r))})})},t}(o);t.JQueryRequestor=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.xhr=function(e){if(!e.url)return Promise.reject(new N.AppAuthError("A URL must be provided."));var t=new URL(e.url),n={};if(n.method=e.method,n.mode="cors",e.data&&(e.method&&"POST"===e.method.toUpperCase()?n.body=e.data:new URLSearchParams(e.data).forEach(function(e,n){t.searchParams.append(n,e)})),n.headers={},e.headers)for(var r in e.headers)e.headers.hasOwnProperty(r)&&(n.headers[r]=e.headers[r]);var o=e.dataType&&"json"===e.dataType.toLowerCase();return o&&(n.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(t.toString(),n).then(function(e){if(e.status>=200&&e.status<300){var t=e.headers.get("content-type");return o||t&&-1!==t.indexOf("application/json")?e.json():e.text()}return Promise.reject(new N.AppAuthError(e.status.toString(),e.statusText))})},t}(o);t.FetchRequestor=a;var s=function(e){function t(t){var n=e.call(this)||this;return n.promise=t,n}return r(t,e),t.prototype.xhr=function(e){return this.promise},t}(o);t.TestRequestor=s}),q=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationServiceConfiguration=void 0;var n=function(){function e(e){this.authorizationEndpoint=e.authorization_endpoint,this.tokenEndpoint=e.token_endpoint,this.revocationEndpoint=e.revocation_endpoint,this.userInfoEndpoint=e.userinfo_endpoint,this.endSessionEndpoint=e.end_session_endpoint}return e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fetchFromIssuer=function(t,n){var r=t+"/.well-known/openid-configuration";return(n||new j.JQueryRequestor).xhr({url:r,dataType:"json",method:"GET"}).then(function(t){return new e(t)})},e}();t.AuthorizationServiceConfiguration=n}),D=[],z=[],M=("undefined"!=typeof Uint8Array&&Uint8Array,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),B=0,F=M.length;B<F;++B)D[B]=M[B],z[M.charCodeAt(B)]=B;function G(e){return D[e>>18&63]+D[e>>12&63]+D[e>>6&63]+D[63&e]}function H(e,t,n){for(var r=[],o=t;o<n;o+=3)r.push(G((e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2])));return r.join("")}z["-".charCodeAt(0)]=62,z["_".charCodeAt(0)]=63;var Z=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCrypto=t.textEncodeLite=t.urlSafe=t.bufferToString=void 0;var n="undefined"!=typeof window&&!!window.crypto,r=n&&!!window.crypto.subtle,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function i(e){for(var t=[],n=0;n<e.byteLength;n+=1)t.push(o[e[n]%o.length]);return t.join("")}function a(e){return function(e){for(var t,n=e.length,r=n%3,o=[],i=16383,a=0,s=n-r;a<s;a+=i)o.push(H(e,a,a+i>s?s:a+i));return 1===r?o.push(D[(t=e[n-1])>>2]+D[t<<4&63]+"=="):2===r&&o.push(D[(t=(e[n-2]<<8)+e[n-1])>>10]+D[t>>4&63]+D[t<<2&63]+"="),o.join("")}(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function s(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}t.bufferToString=i,t.urlSafe=a,t.textEncodeLite=s;var c=function(){function e(){}return e.prototype.generateRandom=function(e){var t=new Uint8Array(e);if(n)window.crypto.getRandomValues(t);else for(var r=0;r<e;r+=1)t[r]=Math.random()*o.length|0;return i(t)},e.prototype.deriveChallenge=function(e){return e.length<43||e.length>128?Promise.reject(new N.AppAuthError("Invalid code length.")):r?new Promise(function(t,n){crypto.subtle.digest("SHA-256",s(e)).then(function(e){return t(a(new Uint8Array(e)))},function(e){return n(e)})}):Promise.reject(new N.AppAuthError("window.crypto.subtle is unavailable."))},e}();t.DefaultCrypto=c}),J=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IS_PROFILE=t.IS_LOG=void 0,t.IS_LOG=!0,t.IS_PROFILE=!1}),Y=(0,w.c)(function(e,t){var n=w.a&&w.a.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};function r(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(J.IS_LOG){var o=t?t.length:0;o>0?console.log.apply(console,n([e],t)):console.log(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.profile=t.log=void 0,t.log=r;var o="undefined"!=typeof window&&!!window.performance&&!!console.profile;t.profile=function(e,t,i){return J.IS_PROFILE?function(e,t,i){var a=i.value,s=a.name;return s||(s="anonymous function"),i.value=o?function(e){console.profile(s);var t=window.performance.now(),r=a.call.apply(a,n([this||window],e)),o=window.performance.now()-t;return console.log(s+" took "+o+" ms"),console.profileEnd(),r}:function(e){r("Profile start "+s);var t=Date.now(),o=a.call.apply(a,n([this||window],e)),i=Date.now()-t;return r("Profile end "+s+" took "+i+" ms."),o},i}(0,0,i):i}}),V=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequest=void 0;var n=function(){function e(t,n,r){void 0===n&&(n=new Z.DefaultCrypto),void 0===r&&(r=!0),this.crypto=n,this.usePkce=r,this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.scope=t.scope,this.responseType=t.response_type||e.RESPONSE_TYPE_CODE,this.state=t.state||function(e){return e.generateRandom(10)}(n),this.extras=t.extras,this.internal=t.internal}return e.prototype.setupCodeVerifier=function(){var e=this;if(this.usePkce){var t=this.crypto.generateRandom(128);return this.crypto.deriveChallenge(t).catch(function(e){Y.log("Unable to generate PKCE challenge. Not using PKCE",e)}).then(function(n){n&&(e.internal=e.internal||{},e.internal.code_verifier=t,e.extras=e.extras||{},e.extras.code_challenge=n,e.extras.code_challenge_method="S256")})}return Promise.resolve()},e.prototype.toJson=function(){var e=this;return this.setupCodeVerifier().then(function(){return{response_type:e.responseType,client_id:e.clientId,redirect_uri:e.redirectUri,scope:e.scope,state:e.state,extras:e.extras,internal:e.internal}})},e.RESPONSE_TYPE_TOKEN="token",e.RESPONSE_TYPE_CODE="code",e}();t.AuthorizationRequest=n}),Q=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequestHandler=t.BUILT_IN_PARAMETERS=t.AuthorizationNotifier=void 0;var n=function(){function e(){this.listener=null}return e.prototype.setAuthorizationListener=function(e){this.listener=e},e.prototype.onAuthorizationComplete=function(e,t,n){this.listener&&this.listener(e,t,n)},e}();t.AuthorizationNotifier=n,t.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var r=function(){function e(e,t){this.utils=e,this.crypto=t,this.notifier=null}return e.prototype.buildRequestUrl=function(e,n){var r={redirect_uri:n.redirectUri,client_id:n.clientId,response_type:n.responseType,state:n.state,scope:n.scope};if(n.extras)for(var o in n.extras)n.extras.hasOwnProperty(o)&&t.BUILT_IN_PARAMETERS.indexOf(o)<0&&(r[o]=n.extras[o]);var i=this.utils.stringify(r);return e.authorizationEndpoint+"?"+i},e.prototype.completeAuthorizationRequestIfPossible=function(){var e=this;return Y.log("Checking to see if there is an authorization response to be delivered."),this.notifier||Y.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then(function(t){t||Y.log("No result is available yet."),t&&e.notifier&&e.notifier.onAuthorizationComplete(t.request,t.response,t.error)})},e.prototype.setAuthorizationNotifier=function(e){return this.notifier=e,this},e}();t.AuthorizationRequestHandler=r}),K=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationError=t.AuthorizationResponse=void 0;var n=function(){function e(e){this.code=e.code,this.state=e.state}return e.prototype.toJson=function(){return{code:this.code,state:this.state}},e}();t.AuthorizationResponse=n;var r=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri,this.state=e.state}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},e}();t.AuthorizationError=r}),W=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BasicQueryStringUtils=void 0;var n=function(){function e(){}return e.prototype.parse=function(e,t){return this.parseQueryString(t?e.hash:e.search)},e.prototype.parseQueryString=function(e){for(var t={},n=(e=e.trim().replace(/^(\?|#|&)/,"")).split("&"),r=0;r<n.length;r+=1){var o=n[r].split("=");if(o.length>=2){var i=decodeURIComponent(o.shift()),a=o.length>0?o.join("="):null;a&&(t[i]=decodeURIComponent(a))}}return t},e.prototype.stringify=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&e[n]&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},e}();t.BasicQueryStringUtils=n}),X=(0,w.c)(function(e,t){var n,r=w.a&&w.a.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageBackend=t.StorageBackend=void 0;var o=function(){};t.StorageBackend=o;var i=function(e){function t(t){var n=e.call(this)||this;return n.storage=t||window.localStorage,n}return r(t,e),t.prototype.getItem=function(e){var t=this;return new Promise(function(n,r){n(t.storage.getItem(e)||null)})},t.prototype.removeItem=function(e){var t=this;return new Promise(function(n,r){t.storage.removeItem(e),n()})},t.prototype.clear=function(){var e=this;return new Promise(function(t,n){e.storage.clear(),t()})},t.prototype.setItem=function(e,t){var n=this;return new Promise(function(r,o){n.storage.setItem(e,t),r()})},t}(o);t.LocalStorageBackend=i}),ee=(0,w.c)(function(e,t){var n,r=w.a&&w.a.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectRequestHandler=void 0;var o=function(e){return e+"_appauth_authorization_request"},i=function(e){return e+"_appauth_authorization_service_configuration"},a="appauth_current_authorization_request",s=function(e){function t(t,n,r,o){void 0===t&&(t=new X.LocalStorageBackend),void 0===n&&(n=new W.BasicQueryStringUtils),void 0===r&&(r=window.location),void 0===o&&(o=new Z.DefaultCrypto);var i=e.call(this,n,o)||this;return i.storageBackend=t,i.locationLike=r,i}return r(t,e),t.prototype.performAuthorizationRequest=function(e,t){var n=this,r=this.crypto.generateRandom(10);Promise.all([this.storageBackend.setItem(a,r),t.toJson().then(function(e){return n.storageBackend.setItem(o(r),JSON.stringify(e))}),this.storageBackend.setItem(i(r),JSON.stringify(e.toJson()))]).then(function(){var r=n.buildRequestUrl(e,t);Y.log("Making a request to ",t,r),n.locationLike.assign(r)})},t.prototype.completeAuthorizationRequest=function(){var e=this;return this.storageBackend.getItem(a).then(function(t){return t?e.storageBackend.getItem(o(t)).then(function(e){return JSON.parse(e)}).then(function(e){return new V.AuthorizationRequest(e)}).then(function(n){var r=""+e.locationLike.origin+e.locationLike.pathname,s=e.utils.parse(e.locationLike,!0),c=s.state,u=s.code,l=s.error;Y.log("Potential authorization request ",r,s,c,u,l);var h=null,p=null;return c===n.state?(l?p=new K.AuthorizationError({error:l,error_description:s.error_description,error_uri:s.error_uri,state:c}):h=new K.AuthorizationResponse({code:u,state:c}),Promise.all([e.storageBackend.removeItem(a),e.storageBackend.removeItem(o(t)),e.storageBackend.removeItem(i(t))]).then(function(){return Y.log("Delivering authorization response"),{request:n,response:h,error:p}})):(Y.log("Mismatched request (state and request_uri) dont match."),Promise.resolve(null))}):null})},t}(Q.AuthorizationRequestHandler);t.RedirectRequestHandler=s}),te=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=t.TokenResponse=t.nowInSeconds=void 0,t.nowInSeconds=function(){return Math.round((new Date).getTime()/1e3)};var n=function(){function e(e){this.accessToken=e.access_token,this.tokenType=e.token_type||"bearer",e.expires_in&&(this.expiresIn=parseInt(e.expires_in,10)),this.refreshToken=e.refresh_token,this.scope=e.scope,this.idToken=e.id_token,this.issuedAt=e.issued_at||t.nowInSeconds()}return e.prototype.toJson=function(){var e;return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:null===(e=this.expiresIn)||void 0===e?void 0:e.toString()}},e.prototype.isValid=function(e){return void 0===e&&(e=-600),!this.expiresIn||t.nowInSeconds()<this.issuedAt+this.expiresIn+e},e}();t.TokenResponse=n;var r=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e}();t.TokenError=r}),ne=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTokenRequestHandler=void 0;var n=function(){function e(e,t){void 0===e&&(e=new j.JQueryRequestor),void 0===t&&(t=new W.BasicQueryStringUtils),this.requestor=e,this.utils=t}return e.prototype.isTokenResponse=function(e){return void 0===e.error},e.prototype.performRevokeTokenRequest=function(e,t){return this.requestor.xhr({url:e.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then(function(e){return!0})},e.prototype.performTokenRequest=function(e,t){var n=this;return this.requestor.xhr({url:e.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then(function(e){return n.isTokenResponse(e)?new te.TokenResponse(e):Promise.reject(new N.AppAuthError(e.error,new te.TokenError(e)))})},e}();t.BaseTokenRequestHandler=n}),re=(0,w.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequest=t.GRANT_TYPE_REFRESH_TOKEN=t.GRANT_TYPE_AUTHORIZATION_CODE=void 0,t.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",t.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var n=function(){function e(e){this.clientId=e.client_id,this.redirectUri=e.redirect_uri,this.grantType=e.grant_type,this.code=e.code,this.refreshToken=e.refresh_token,this.extras=e.extras}return e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var e={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(e.code=this.code),this.refreshToken&&(e.refresh_token=this.refreshToken),this.extras)for(var t in this.extras)this.extras.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.extras[t]);return e},e}();t.TokenRequest=n}),oe=function(t){i(o,t);var r=s(o);function o(t,n,i){var a;return e(this,o),(a=r.call(this)).code=t,a.state=n,a.error=i,a}return n(o,[{key:"parse",value:function(e,t){return{code:this.code,state:this.state,error:this.error}}}]),o}(W.BasicQueryStringUtils),ie=function(){function t(){e(this,t),this.config=null,this.fetchRequestor=new j.FetchRequestor,this.tokenHandler=new ne.BaseTokenRequestHandler(this.fetchRequestor),this.locationLike=null}return n(t,[{key:"recieveMessage",value:function(e){var t=e.data,n=this;return(0,c.Z)(l().mark(function e(){var r,o,i,a,s,c,u,h,p,f,v,g,y,w,k,b;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,d.d)("silent_auth","Received message event"),s=(0,m.g)(t.error),c=(0,m.g)(t.code),u=(0,m.g)(t.state),!(0,m.i)(s)){e.next=5;break}throw h="Received error from message, ".concat(s),(0,d.e)("silent_auth",h),new Error(h);case 5:if((0,m.i)(c)&&(0,m.i)(u)){e.next=7;break}return e.abrupt("return","");case 7:if(null!=n.authorizationHandler){e.next=9;break}return e.abrupt("return",((0,d.d)("silent_auth","Received message event but authorizationHandler not initialised"),""));case 9:if(p=n.config||{},f=p.LOGIN_REDIRECT_URL,v=p.CLIENT_ID,g=(0,m.g)(v),y=(0,m.g)(f),(0,m.i)(g)){e.next=12;break}throw new Error("config was not set on silent auth service");case 12:return n.authorizationHandler.locationLike=_.w.location,n.authorizationHandler.utils=new oe(c,u,s),e.prev=13,e.next=16,n.authorizationHandler.completeAuthorizationRequest();case 16:w=e.sent,e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(13),(0,d.e)("silent_auth","Complete authorization request failed: ".concat(JSON.stringify(e.t0.message))),e.t0;case 22:return(0,d.d)("silent_auth","Authorization Request Response received. Trying to get token..."),e.prev=23,h=new re.TokenRequest({client_id:g,redirect_uri:y,grant_type:re.GRANT_TYPE_AUTHORIZATION_CODE,code:null===(r=null==w?void 0:w.response)||void 0===r?void 0:r.code,refresh_token:void 0,extras:{prompt:"none",code_verifier:null!==(a=null===(i=null===(o=null==w?void 0:w.request)||void 0===o?void 0:o.internal)||void 0===i?void 0:i.code_verifier)&&void 0!==a?a:""}}),e.next=27,n.tokenHandler.performTokenRequest(n.authorizationServiceConfiguration,h);case 27:k=e.sent,e.next=33;break;case 30:throw e.prev=30,e.t1=e.catch(23),(0,d.e)("silent_auth","Token request failed: ".concat(JSON.stringify(e.t1.message))),e.t1;case 33:if((0,d.d)("silent_auth","Token request completed successfully"),(0,m.i)(k.accessToken)){e.next=36;break}throw b="Token request failed: access token not present in response",(0,d.e)("silent_auth",b),new Error(b);case 36:return e.abrupt("return",k.accessToken);case 37:case"end":return e.stop()}},e,null,[[13,19],[23,30]])}))()}},{key:"setConfig",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){var r,o,i;return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.config=e,r=t.config||{},o=r.LOGIN_BASE_URL,i=(0,m.g)(o),n.t0=(0,m.i)(i),!n.t0){n.next=7;break}return n.next=6,q.AuthorizationServiceConfiguration.fetchFromIssuer(i,t.fetchRequestor);case 6:t.authorizationServiceConfiguration=n.sent;case 7:case"end":return n.stop()}},n)}))()}},{key:"fetchAccessToken",value:function(){var e,t=this.config||{},n=t.CLIENT_ID,r=t.LOGIN_REDIRECT_URL,o=(0,m.g)(n),i=(0,m.g)(r);if(!(0,m.i)(o)||!(0,m.i)(i))throw new Error("Config has not been set.");if(void 0===this.authorizationServiceConfiguration)throw new Error("oauth config has not been fetched.");if(null===this.locationLike&&(this.locationLike=_.w.getIframeLocationLike("auth-iframe-navigation-header")),"function"!=typeof(null===(e=this.locationLike)||void 0===e?void 0:e.assign))throw new Error("unable to perform authorization request due to incompatible locationLike");var a=new X.LocalStorageBackend(_.w.sessionStorage);if("function"!=typeof a.setItem)throw new Error("invalid storage backend provided");this.authorizationHandler=new ee.RedirectRequestHandler(a,new oe("","",""),this.locationLike,{generateRandom:_.w.generateRandom,deriveChallenge:_.w.deriveChallenge});var s=new V.AuthorizationRequest({client_id:o,redirect_uri:i,scope:"openid",response_type:V.AuthorizationRequest.RESPONSE_TYPE_CODE,state:void 0,extras:{prompt:"none"}},{generateRandom:_.w.generateRandom,deriveChallenge:_.w.deriveChallenge});this.authorizationHandler.performAuthorizationRequest(this.authorizationServiceConfiguration,s)}}]),t}(),ae=function(){function t(){e(this,t),this.config=null,this.isPorscheCom=!1,this.silentAuthService=null,this.initialisingSilentAuthService=!1}return n(t,[{key:"setConfig",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("object"!=typeof e||null===e){n.next=14;break}if(t.config=e,t.isPorscheCom=t.config.PORSCHE_COM_URL.some(function(e){return e.includes(_.w.location.origin)}),null===t.silentAuthService){n.next=12;break}return n.prev=2,n.next=5,t.silentAuthService.setConfig(t.config);case 5:n.next=12;break;case 7:return n.prev=7,n.t0=n.catch(2),(0,d.e)("user_service_set_config","Could not set silent auth config: ".concat(n.t0)),n.next=12,t.silentAuthService.setConfig(null);case 12:n.next=15;break;case 14:t.config=null,t.isPorscheCom=!1;case 15:case"end":return n.stop()}},n,null,[[2,7]])}))()}},{key:"getUserData",value:function(e,t){var n=this;return(0,c.Z)(l().mark(function r(){var o,i,a,s,c,u,h,p,v,g;return l().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s=(0,f.s)(t),c=s.language,u=s.country,h={method:"GET",headers:{"Accept-Language":"".concat(c,"_").concat(u),"x-trace-id":P(),apikey:(0,m.g)(null===(o=n.config)||void 0===o?void 0:o.CLIENT_ID),Authorization:"Bearer ".concat(e),Accept:"application/json"}},p=(0,m.i)(u)?"?country=".concat(u):"",r.prev=1,r.next=4,fetch("".concat((0,m.g)(null===(i=n.config)||void 0===i?void 0:i.PROFILE_API_URL)).concat(p),h);case 4:a=r.sent,r.next=11;break;case 7:throw r.prev=7,r.t0=r.catch(1),v="Exception occurred while fetching user info: ".concat(JSON.stringify(r.t0.message)),(0,d.e)("user_profile",v),new Error(v);case 11:if(200===a.status){r.next=14;break}throw g="Error occurred: ".concat(a.status," ").concat(a.statusText),(0,d.e)("user_profile",g),new Error(g);case 14:return r.abrupt("return",a.json());case 15:case"end":return r.stop()}},r,null,[[1,7]])}))()}},{key:"getUnreadMessagesCount",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){var r,o,i,a,s,c,u;return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a={method:"GET",headers:{"x-trace-id":P(),apikey:(0,m.g)(null===(r=t.config)||void 0===r?void 0:r.CLIENT_ID),Authorization:"Bearer ".concat(e),Accept:"application/json"}},s=null,n.prev=2,n.next=5,fetch((0,m.g)(null===(o=t.config)||void 0===o?void 0:o.UNREAD_MESSAGES_COUNT_API_URL),a);case 5:s=n.sent,n.next=12;break;case 8:n.prev=8,n.t0=n.catch(2),c="Exception occurred while fetching unread message count: ".concat(JSON.stringify(n.t0.message)),(0,d.e)("unread_messages_count",c);case 12:if(null===s){n.next=24;break}if(200!==s.status){n.next=21;break}return n.next=16,s.json();case 16:if(u=n.sent,"number"!=typeof(null===(i=null==u?void 0:u.data)||void 0===i?void 0:i.unreadCount)){n.next=19;break}return n.abrupt("return",u.data.unreadCount);case 19:n.next=22;break;case 21:(0,d.e)("unread_messages_count","Error occurred: ".concat(s.status," ").concat(s.statusText));case 22:n.next=25;break;case 24:(0,d.e)("unread_messages_count","Error occurred: unreadMessagesCountResponse not formed");case 25:return n.abrupt("return",0);case 26:case"end":return n.stop()}},n,null,[[2,8]])}))()}},{key:"newMessageEventReceived",value:function(e,t,n){var r=this;return(0,c.Z)(l().mark(function o(){var i;return l().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(null!==r.silentAuthService){o.next=2;break}return o.abrupt("return",((0,d.i)("user_service","auth message received but silent auth service not initialised - venting"),t));case 2:return o.prev=2,o.next=5,r.silentAuthService.recieveMessage(e);case 5:i=o.sent,o.next=11;break;case 8:return o.prev=8,o.t0=o.catch(2),o.abrupt("return",(y.n.state.loggedInState=m.L,""));case 11:return o.abrupt("return",(0,m.i)(i)?r.accessTokenUpdated(i,t,n,!0):t);case 12:case"end":return o.stop()}},o,null,[[2,8]])}))()}},{key:"accessTokenUpdated",value:function(e,n,r,o){var i=this;return(0,c.Z)(l().mark(function a(){var s,c,u,h;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e!==m.R){a.next=2;break}return a.abrupt("return",n);case 2:if(null!==i.config){a.next=4;break}return a.abrupt("return",e);case 4:if(y.n.state.loggedInState=m.a,c=0,u=m.L,(0,m.i)(e)){a.next=26;break}if(i.isPorscheCom&&o){a.next=9;break}return a.abrupt("return",(y.n.state.unreadMessagesCount=c,y.n.state.loggedInState=u,""));case 9:if(!i.initialisingSilentAuthService){a.next=11;break}return a.abrupt("return","");case 11:if(a.prev=11,a.t0=null===i.silentAuthService,!a.t0){a.next=19;break}return i.initialisingSilentAuthService=!0,i.silentAuthService=new ie,a.next=18,i.silentAuthService.setConfig(i.config);case 18:i.initialisingSilentAuthService=!1;case 19:i.silentAuthService.fetchAccessToken(),a.next=25;break;case 22:a.prev=22,a.t1=a.catch(11),(0,d.e)("user_service","could not init silent auth service: ".concat(a.t1)),y.n.state.unreadMessagesCount=c,y.n.state.loggedInState=u;case 25:return a.abrupt("return","");case 26:if((0,m.i)(r)){a.next=28;break}return a.abrupt("return",e);case 28:return a.prev=28,a.next=31,i.getUserData(e,r);case 31:return h=a.sent,u=t.getUserNameFromUserData(h)||m.b,a.next=35,t.getUserIdFromUserData(h);case 35:s=a.sent,a.next=41;break;case 38:throw a.prev=38,a.t2=a.catch(28),y.n.state.unreadMessagesCount=c,y.n.state.loggedInState=u,a.t2;case 41:return a.prev=41,a.next=44,i.getUnreadMessagesCount(e);case 44:c=a.sent,a.next=49;break;case 47:a.prev=47,a.t3=a.catch(41);case 49:return a.abrupt("return",(y.n.state.unreadMessagesCount=c,y.n.state.loggedInState=u,f.a.state.userId=s,e));case 50:case"end":return a.stop()}},a,null,[[11,22],[28,38],[41,47]])}))()}},{key:"revokeAccessToken",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){var r,o,i,a,s;return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t.config&&(0,m.i)(e)){n.next=2;break}return n.abrupt("return");case 2:return r=t.config,o=r.LOGIN_BASE_URL,i=r.CLIENT_ID,n.prev=3,n.next=6,fetch("".concat(o,"/as/revoke_token.oauth2"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"token=".concat(encodeURIComponent(e),"&client_id=").concat(encodeURIComponent(i))});case 6:a=n.sent,n.next=13;break;case 9:throw n.prev=9,n.t0=n.catch(3),s="Exception occurred while revoking access token: ".concat(JSON.stringify(n.t0.message)),(0,d.e)("revoke_access_token",s),n.t0;case 13:if(a.ok){n.next=15;break}throw(0,d.e)("revoke_access_token",401===a.status?"Unauthorized revocation attempt":"Error when revoking acccess token"),new Error("Revoke access token failed");case 15:case"end":return n.stop()}},n,null,[[3,9]])}))()}}],[{key:"getUserNameFromUserData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="",n=(0,m.g)(e.firstName),r=(0,m.g)(e.middleName),o=(0,m.g)(e.lastName);return(0,m.i)(n)?(t=n,(0,m.i)(r)?(t+=" ".concat(r),(0,m.i)(o)&&(t+=" ".concat(o))):(0,m.i)(o)&&(t+=" ".concat(o))):(0,m.i)(r)?(t=r,(0,m.i)(o)&&(t+=" ".concat(o))):(0,m.i)(o)&&(t=o),t}},{key:"getUserIdFromUserData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,c.Z)(l().mark(function t(){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.w.hashString((0,m.g)(e.porscheId));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))()}}]),t}(),se=function(){function t(n){e(this,t),(0,h.r)(this,n),this.accessTokenExpired=(0,h.c)(this,"accessTokenExpired",7),this.navigationDidLoad=(0,h.c)(this,"navigationDidLoad",7),this.phnLogout=(0,h.c)(this,"phnLogout",6),this.accessToken="",this.locale="",this.env="",this.config=null,this.accessTokenState="",this.accessibilityStatement=m.D,this.countryRecommenderContent=m.c,this.scrolledPastHeader=!1,this.breakpoint=_.w.getBreakpoint(),this.showCountryRecommender=_.w.redirected,this.countryRecommenderClosed=!1,this.menuDrawerClosed=!0,this.hasFetchedContent=!1,this.userService=new ae}return n(t,[{key:"localeWatchHandler",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f.a.state.locale.setLocale(e.locale),t.next=3,e.initNavContentStore();case 3:case"end":return t.stop()}},t)}))()}},{key:"newAccessTokenReceived",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.accessToken!==m.R,!t.t0){t.next=7;break}if(t.t1=e.accessToken!==e.accessTokenState,!t.t1){t.next=6;break}return t.next=6,e.accessTokenStateUpdated(e.accessToken);case 6:e.accessToken=m.R;case 7:case"end":return t.stop()}},t)}))()}},{key:"newEnvReceived",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initEnvironment();case 2:return t.next=4,e.initNavContentStore();case 4:return t.next=6,e.accessTokenStateUpdated(e.accessTokenState);case 6:case"end":return t.stop()}},t)}))()}},{key:"scrollHandler",value:function(){this.scrolledPastHeader=this.el.getBoundingClientRect().bottom<=0}},{key:"newAuthMessageReceived",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){var r,o,i;return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.config||{},o=r.LOGIN_REDIRECT_URL,i=(0,m.g)(o),n.t0=(0,m.i)(i)&&(0,m.i)(e.origin)&&i.startsWith(e.origin),!n.t0){n.next=6;break}return n.next=5,t.userService.newMessageEventReceived(e,t.accessTokenState,t.locale);case 5:t.accessTokenState=n.sent;case 6:case"end":return n.stop()}},n)}))()}},{key:"handleLogout",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.userService.revokeAccessToken(t.accessTokenState);case 3:n.next=8;break;case 5:return n.prev=5,n.t0=n.catch(0),n.abrupt("return");case 8:t.phnLogout.emit(),_.w.location=e.detail;case 9:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"resizeHandler",value:function(){this.breakpoint=_.w.getBreakpoint()}},{key:"accessTokenStateUpdated",value:function(e){var t=this;return(0,c.Z)(l().mark(function n(){var r;return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=k.n.state.metafunctionalities.length>1,n.prev=1,n.next=4,t.userService.accessTokenUpdated(e,t.accessTokenState,t.locale,r);case 4:t.accessTokenState=n.sent,n.next=10;break;case 7:n.prev=7,n.t0=n.catch(1),t.accessTokenExpired.emit(),t.accessTokenState="";case 10:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"initEnvironment",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){var n;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Object.keys(E),!(0,m.i)(e.env)||!n.includes(e.env)){t.next=9;break}return e.config=E[e.env],g.f.setFeatures(e.env),t.next=6,e.userService.setConfig(e.config);case 6:f.a.set("environment",e.env),t.next=10;break;case 9:e.env=m.d;case 10:case"end":return t.stop()}},t)}))()}},{key:"initNavContentStore",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){var n;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((0,m.i)(e.locale)&&null!==e.config){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,S(e.config.CONTENT_URL,e.locale);case 5:n=t.sent,t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return");case 11:Object.keys(n).forEach(function(e){k.n.set(e,n[e])}),g.f.isFeatureEnabled(m.F,_.w.location.search)&&k.n.set("dealer",b.m),e.accessibilityStatement=k.n.state.accessibilityStatement,e.countryRecommenderContent=k.n.state.countryRecommender,(0,m.i)(e.clientId)&&(y.n.state.applicationClientId=e.clientId),e.hasFetchedContent=!0;case 12:case"end":return t.stop()}},t,null,[[2,8]])}))()}},{key:"componentWillLoad",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.el.style.setProperty("--scrollbar-width",_.w.getScrollbarWidth()),(0,m.i)(e.locale)&&f.a.state.locale.setLocale(e.locale),t.next=4,e.initEnvironment();case 4:return t.next=6,e.initNavContentStore();case 6:(0,m.i)(e.accessToken)&&e.accessToken!==m.R&&(e.accessTokenState=e.accessToken,e.accessToken=m.R);case 7:case"end":return t.stop()}},t)}))()}},{key:"componentDidLoad",value:function(){var e=this;return(0,c.Z)(l().mark(function t(){var n;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new T(f.a.state),(f.a.state.w.pagData=f.a.state.w.pagData||[]).push(n.event()),y.n.state.navigationLoaded?(_.w.navigationLoaded=!0,e.navigationDidLoad.emit()):y.n.onChange("navigationLoaded",function(){_.w.navigationLoaded=!0,e.navigationDidLoad.emit()}),_.w.version=m.V,t.next=6,e.accessTokenStateUpdated(e.accessTokenState);case 6:case"end":return t.stop()}},t)}))()}},{key:"skipToMainContent",value:function(e){var t;e.stopPropagation();var n=(0,m.e)(null===(t=this.el.shadowRoot)||void 0===t?void 0:t.querySelector("#main"));null!==n&&(n.tabIndex=0,n.focus())}},{key:"mainContentTab",value:function(){var e,t=(0,m.e)(null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("#main"));null!==t&&(t.tabIndex=-1)}},{key:"addFocus",value:function(){var e,t,n=(0,m.e)(null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("phn-p-button.skip-content"));if(null!==n){n.classList.add("focused");var r=(0,m.e)(null===(t=this.el.shadowRoot)||void 0===t?void 0:t.querySelector("phn-crest phn-p-marque"));null!==r&&(n.style.left="".concat(r.getBoundingClientRect().left,"px"))}}},{key:"removeFocus",value:function(){var e,t=(0,m.e)(null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("phn-p-button.skip-content"));null!==t&&(t.classList.remove("focused"),t.style.left="")}},{key:"render",value:function(){var e=this,t=this.config||{},n=t.ASSETS_URL,r=void 0===n?"":n,o=t.COUNTRY_SELECTOR_URL,i=void 0===o?"":o,a=t.FOOTER_ASSETS_URL,s=void 0===a?"":a,c=t.LOGIN_BASE_URL,u=void 0===c?"":c,l=t.DEALER_API_URL,d=void 0===l?"":l;return(0,m.i)(y.n.state.loggedInState)&&(f.a.state.loginStatus=(0,m.f)(y.n.state.loggedInState)),(0,h.h)(h.H,null,this.showCountryRecommender&&null!==this.countryRecommenderContent&&!this.countryRecommenderClosed?(0,h.h)("phn-country-recommender",{locale:this.locale,content:this.countryRecommenderContent,assetsURL:s,countrySelectorURL:i,role:"region","aria-label":"Change recommended Region or Language",onBannerClosed:function(){e.countryRecommenderClosed=!0}}):null,"en-US"===this.locale&&null!==this.accessibilityStatement?(0,h.h)("a",{class:"sr-only",href:this.accessibilityStatement.Link},this.accessibilityStatement.Text):null,(0,h.h)("phn-p-button",{variant:"primary",class:"skip-content",onFocus:function(){return e.addFocus()},onClick:function(t){return e.skipToMainContent(t)},onBlur:function(){return e.removeFocus()}},"Skip to main content"),(0,h.h)("header",null,(0,h.h)("phn-p-flex",{class:"header-content","justify-content":"space-between"},(0,h.h)("phn-crest",{breakpoint:this.breakpoint}),this.hasFetchedContent?this.breakpoint<p.b.l?(0,h.h)("phn-burger-button",{onClick:function(t){e.usingKeyboard=(0,m.h)(t),e.menuDrawerClosed=!e.menuDrawerClosed}}):(0,h.h)("phn-menu-desktop-level-1",{assetsURL:r,loginURL:u,breakpoint:this.breakpoint}):null),this.breakpoint<p.b.l&&!this.menuDrawerClosed?(0,h.h)("phn-menu-drawer",{assetsURL:r,loginURL:u,breakpoint:this.breakpoint,initialUsingKeyboard:this.usingKeyboard,dealerApiUrl:d,onDrawerClosed:function(t){var n,r,o=t.detail.usingKeyboard;e.menuDrawerClosed=!0,e.usingKeyboard=o,o&&(null===(r=(0,m.e)(null===(n=e.el.shadowRoot)||void 0===n?void 0:n.querySelector("phn-burger-button phn-p-button-pure")))||void 0===r||r.focus())}}):null),(0,h.h)("div",{class:"header-border"}),"preview"===this.env?(0,h.h)("phn-preview-badge",{versionString:"Header ".concat(m.V," - PP content")}):null,(0,h.h)("div",{id:"main",tabindex:"-1",class:"main-content",onBlur:function(){return e.mainContentTab()}}))}},{key:"el",get:function(){return(0,h.g)(this)}}],[{key:"assetsDirs",get:function(){return["auth"]}},{key:"watchers",get:function(){return{locale:["localeWatchHandler"],accessToken:["newAccessTokenReceived"],env:["newEnvReceived"]}}}]),t}();se.style='@-webkit-keyframes slideDown{from{max-height:0}to{max-height:1000px}}@keyframes slideDown{from{max-height:0}to{max-height:1000px}}@-webkit-keyframes slideUp{from{max-height:1000px}to{max-height:0}}@keyframes slideUp{from{max-height:1000px}to{max-height:0}}@-webkit-keyframes slideLeft{from{max-width:0}to{max-width:1000px}}@keyframes slideLeft{from{max-width:0}to{max-width:1000px}}@-webkit-keyframes slideRight{from{max-width:1000px}to{max-width:0}}@keyframes slideRight{from{max-width:1000px}to{max-width:0}}@-webkit-keyframes darken{from{background-color:rgba(0, 0, 0, 0)}to{background-color:rgba(0, 0, 0, 0.8)}}@keyframes darken{from{background-color:rgba(0, 0, 0, 0)}to{background-color:rgba(0, 0, 0, 0.8)}}@-webkit-keyframes lighten{from{background-color:rgba(0, 0, 0, 0.8)}to{background-color:rgba(0, 0, 0, 0)}}@keyframes lighten{from{background-color:rgba(0, 0, 0, 0.8)}to{background-color:rgba(0, 0, 0, 0)}}@-webkit-keyframes fadeIn{0%{opacity:0;top:36px}100%{opacity:1;top:0px}}@keyframes fadeIn{0%{opacity:0;top:36px}100%{opacity:1;top:0px}}:host{display:block;position:relative;background-color:#fff;visibility:visible;height:auto !important}:host header{font-family:"Porsche Next", "Arial Narrow", Arial, "Heiti SC", SimHei, sans-serif;font-weight:400;height:3.8125rem;color:#000;-webkit-box-sizing:content-box;box-sizing:content-box;margin:0 7vw}@media (min-width: 1000px){:host header{padding-left:var(--scrollbar-width)}}@media (min-width: 1760px){:host header{margin:0 10vw}}@media (min-width: 1920px){:host header{margin:0 auto;width:96rem}}@media (min-width: 760px){:host header{height:4.4375rem}}@media (min-width: 1300px){:host header{height:7.3125rem;-ms-flex-direction:row;flex-direction:row}}@media (min-width: 1760px){:host header{height:7.6875rem}}:host header .header-content{height:100%}:host header phn-crest{z-index:1;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}@media (min-width: 1300px){:host header phn-crest{z-index:400}}:host header .burger-button:focus{outline-width:2px;outline-style:solid;outline-offset:1px;outline-color:currentColor}:host .header-border{height:1px;background-color:#e3e4e5}:host phn-p-button.skip-content{display:none}@media (min-width: 1000px){:host phn-p-button.skip-content{display:-ms-inline-flexbox;display:inline-flex;left:-999px;position:absolute;width:auto;height:auto;overflow:hidden;z-index:-999}}:host phn-p-button.skip-content.focused{outline-width:2px;outline-style:solid;outline-offset:1px;outline-color:currentColor;overflow:visible;z-index:999}:host .main-content{width:20px}:host .main-content:focus{outline-style:none}:host .sr-only{position:absolute;width:1px;height:1px;white-space:nowrap;overflow:hidden;clip:rect(1px, 1px, 1px, 1px);-webkit-clip-path:inset(50%);clip-path:inset(50%)}'}}])}();
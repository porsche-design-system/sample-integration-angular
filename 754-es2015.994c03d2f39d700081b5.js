"use strict";(self.webpackChunksample_integration_angular=self.webpackChunksample_integration_angular||[]).push([[754],{3754:function(e,t,n){n.r(t),n.d(t,{phn_header:function(){return ee}});var o=n(8239),r=n(4397),i=n(8605),s=n(599),a=n(5305),c=n(4239),u=n(5364),h=n(1342),l=n(837),d=n(7171),p=n(6967),f=n(6430),g=n(1454);n(8082);const v={test:{CONTENT_URL:"http://content/url",ASSETS_URL:"http://assets/url",PROFILE_API_URL:"http://profile-api/url",FOOTER_ASSETS_URL:"http://footer/assets",COUNTRY_SELECTOR_URL:"http://select/countries",UNREAD_MESSAGES_COUNT_API_URL:"http://unread-messages-count-api/url",LOGIN_BASE_URL:"http://login-base/url",LOGIN_REDIRECT_URL:"http://login-redirect/url",CLIENT_ID:"client-id",PORSCHE_COM_URL:["http://porsche-com/url"],DEALER_API_URL:"https://configurator-dev.porsche.com/api/dealer-search/dealers"},local:{CONTENT_URL:"https://preview-nav.porsche.com/content",ASSETS_URL:".",FOOTER_ASSETS_URL:"https://footer.pchomenav.aws.porsche.cloud/assets",COUNTRY_SELECTOR_URL:"https://preview.ppn.porsche.com/countries",PROFILE_API_URL:"https://api.porsche-preview.com/profiles/mydata",UNREAD_MESSAGES_COUNT_API_URL:"https://api.porsche-preview.com/inbox/pp/rest/messages/unreadCount",LOGIN_BASE_URL:"https://preview-login.porsche.com",LOGIN_REDIRECT_URL:"https://preview-nav.porsche.com/authIframe.html",CLIENT_ID:"V5yfGusXVALiypCMRFBfM4IAHaZ0IA4A",PORSCHE_COM_URL:["http://localhost:3333","http://localhost:3334","http://localhost:3335"],DEALER_API_URL:"https://configurator-dev.porsche.com/api/dealer-search/dealers"},preview:{CONTENT_URL:"https://preview-nav.porsche.com/content",ASSETS_URL:"https://preview-nav.porsche.com",FOOTER_ASSETS_URL:"https://footer.pchomenav.aws.porsche.cloud/assets",COUNTRY_SELECTOR_URL:"https://preview.ppn.porsche.com/countries",PROFILE_API_URL:"https://api.porsche-preview.com/profiles/mydata",UNREAD_MESSAGES_COUNT_API_URL:"https://api.porsche-preview.com/inbox/pp/rest/messages/unreadCount",LOGIN_BASE_URL:"https://preview-login.porsche.com",LOGIN_REDIRECT_URL:"https://preview-nav.porsche.com/authIframe.html",CLIENT_ID:"V5yfGusXVALiypCMRFBfM4IAHaZ0IA4A",PORSCHE_COM_URL:["https://vanillajs.preview-nav.porsche.com","https://angular.preview-nav.porsche.com","https://react.preview-nav.porsche.com","https://vanillajs.pchomenav.aws.porsche.cloud","https://react.pchomenav.aws.porsche.cloud","https://angular.pchomenav.aws.porsche.cloud","https://preview.ppn.porsche.com"],DEALER_API_URL:""},production:{CONTENT_URL:"https://nav.porsche.com/00BC524/content",ASSETS_URL:"https://nav.porsche.com/00BC524",FOOTER_ASSETS_URL:"https://nav.porsche.com/00BC524/footer/assets",PROFILE_API_URL:"https://api.porsche.com/profiles/mydata",COUNTRY_SELECTOR_URL:"https://porsche.com/countries",UNREAD_MESSAGES_COUNT_API_URL:"https://api.porsche.com/inbox/p/rest/messages/unreadCount",LOGIN_BASE_URL:"https://login.porsche.com",LOGIN_REDIRECT_URL:"https://nav.porsche.com/00BC524/auth/authIframe.html",CLIENT_ID:"QPw3VOLAMfI7r0nmRY8ELq4RzZpZeXEE",PORSCHE_COM_URL:["https://www.porsche.com"],DEALER_API_URL:""}},m=function(){var e=(0,o.Z)(function*(e,t){let n;try{n=yield fetch(`${e}/${t.toString()}.json`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}})}catch(o){return(0,c.e)("content",`Failed to fetch content with error: ${o}`),a.D}if(404===n.status)throw new Error(`No content for locale ${t} found`);return n.ok?n.json():a.D});return function(t,n){return e.apply(this,arguments)}}();class _ extends u.L{constructor(e){super(e),this.context.eventAction="PAGHomeNav_General_Load"}event(){return super.event()}}var y,w=new Uint8Array(16);function R(){if(!y&&!(y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(w)}const k=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function S(e){return"string"==typeof e&&k.test(e)}for(var E=[],T=0;T<256;++T)E.push((T+256).toString(16).substr(1));function A(e,t,n){var o=(e=e||{}).random||(e.rng||R)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=o[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(E[e[t+0]]+E[e[t+1]]+E[e[t+2]]+E[e[t+3]]+"-"+E[e[t+4]]+E[e[t+5]]+"-"+E[e[t+6]]+E[e[t+7]]+"-"+E[e[t+8]]+E[e[t+9]]+"-"+E[e[t+10]]+E[e[t+11]]+E[e[t+12]]+E[e[t+13]]+E[e[t+14]]+E[e[t+15]]).toLowerCase();if(!S(n))throw TypeError("Stringified UUID is invalid");return n}(o)}for(var C=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AppAuthError=void 0,t.AppAuthError=function(e,t){this.message=e,this.extras=t}}),L=(0,p.c)(function(e,t){var n,o=p.a&&p.a.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.TestRequestor=t.FetchRequestor=t.JQueryRequestor=t.Requestor=void 0;var r=function(){};t.Requestor=r;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.xhr=function(e){var t=$.ajax(e);return new Promise(function(e,n){t.then(function(t,n,o){e(t)},function(e,t,o){n(new C.AppAuthError(o))})})},t}(r);t.JQueryRequestor=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.xhr=function(e){if(!e.url)return Promise.reject(new C.AppAuthError("A URL must be provided."));var t=new URL(e.url),n={};if(n.method=e.method,n.mode="cors",e.data&&(e.method&&"POST"===e.method.toUpperCase()?n.body=e.data:new URLSearchParams(e.data).forEach(function(e,n){t.searchParams.append(n,e)})),n.headers={},e.headers)for(var o in e.headers)e.headers.hasOwnProperty(o)&&(n.headers[o]=e.headers[o]);var r=e.dataType&&"json"===e.dataType.toLowerCase();return r&&(n.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(t.toString(),n).then(function(e){if(e.status>=200&&e.status<300){var t=e.headers.get("content-type");return r||t&&-1!==t.indexOf("application/json")?e.json():e.text()}return Promise.reject(new C.AppAuthError(e.status.toString(),e.statusText))})},t}(r);t.FetchRequestor=s;var a=function(e){function t(t){var n=e.call(this)||this;return n.promise=t,n}return o(t,e),t.prototype.xhr=function(e){return this.promise},t}(r);t.TestRequestor=a}),b=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationServiceConfiguration=void 0;var n=function(){function e(e){this.authorizationEndpoint=e.authorization_endpoint,this.tokenEndpoint=e.token_endpoint,this.revocationEndpoint=e.revocation_endpoint,this.userInfoEndpoint=e.userinfo_endpoint,this.endSessionEndpoint=e.end_session_endpoint}return e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fetchFromIssuer=function(t,n){var o=t+"/.well-known/openid-configuration";return(n||new L.JQueryRequestor).xhr({url:o,dataType:"json",method:"GET"}).then(function(t){return new e(t)})},e}();t.AuthorizationServiceConfiguration=n}),I=[],O=[],U=("undefined"!=typeof Uint8Array&&Uint8Array,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),x=0,P=U.length;x<P;++x)I[x]=U[x],O[U.charCodeAt(x)]=x;function N(e){return I[e>>18&63]+I[e>>12&63]+I[e>>6&63]+I[63&e]}function q(e,t,n){for(var o=[],r=t;r<n;r+=3)o.push(N((e[r]<<16&16711680)+(e[r+1]<<8&65280)+(255&e[r+2])));return o.join("")}O["-".charCodeAt(0)]=62,O["_".charCodeAt(0)]=63;var D=function(e){for(var t,n=e.length,o=n%3,r=[],i=16383,s=0,a=n-o;s<a;s+=i)r.push(q(e,s,s+i>a?a:s+i));return 1===o?r.push(I[(t=e[n-1])>>2]+I[t<<4&63]+"=="):2===o&&r.push(I[(t=(e[n-2]<<8)+e[n-1])>>10]+I[t>>4&63]+I[t<<2&63]+"="),r.join("")},z=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCrypto=t.textEncodeLite=t.urlSafe=t.bufferToString=void 0;var n="undefined"!=typeof window&&!!window.crypto,o=n&&!!window.crypto.subtle,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function i(e){for(var t=[],n=0;n<e.byteLength;n+=1)t.push(r[e[n]%r.length]);return t.join("")}function s(e){return D(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function a(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);return n}t.bufferToString=i,t.urlSafe=s,t.textEncodeLite=a;var c=function(){function e(){}return e.prototype.generateRandom=function(e){var t=new Uint8Array(e);if(n)window.crypto.getRandomValues(t);else for(var o=0;o<e;o+=1)t[o]=Math.random()*r.length|0;return i(t)},e.prototype.deriveChallenge=function(e){return e.length<43||e.length>128?Promise.reject(new C.AppAuthError("Invalid code length.")):o?new Promise(function(t,n){crypto.subtle.digest("SHA-256",a(e)).then(function(e){return t(s(new Uint8Array(e)))},function(e){return n(e)})}):Promise.reject(new C.AppAuthError("window.crypto.subtle is unavailable."))},e}();t.DefaultCrypto=c}),j=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IS_PROFILE=t.IS_LOG=void 0,t.IS_LOG=!0,t.IS_PROFILE=!1}),M=(0,p.c)(function(e,t){var n=p.a&&p.a.__spreadArray||function(e,t){for(var n=0,o=t.length,r=e.length;n<o;n++,r++)e[r]=t[n];return e};function o(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(j.IS_LOG){var r=t?t.length:0;r>0?console.log.apply(console,n([e],t)):console.log(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.profile=t.log=void 0,t.log=o;var r="undefined"!=typeof window&&!!window.performance&&!!console.profile;t.profile=function(e,t,i){return j.IS_PROFILE?function(e,t,i){var s=i.value,a=s.name;return a||(a="anonymous function"),i.value=r?function(e){console.profile(a);var t=window.performance.now(),o=s.call.apply(s,n([this||window],e)),r=window.performance.now()-t;return console.log(a+" took "+r+" ms"),console.profileEnd(),o}:function(e){o("Profile start "+a);var t=Date.now(),r=s.call.apply(s,n([this||window],e)),i=Date.now()-t;return o("Profile end "+a+" took "+i+" ms."),r},i}(0,0,i):i}}),B=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequest=void 0;var n=function(){function e(t,n,o){void 0===n&&(n=new z.DefaultCrypto),void 0===o&&(o=!0),this.crypto=n,this.usePkce=o,this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.scope=t.scope,this.responseType=t.response_type||e.RESPONSE_TYPE_CODE,this.state=t.state||function(e){return e.generateRandom(10)}(n),this.extras=t.extras,this.internal=t.internal}return e.prototype.setupCodeVerifier=function(){var e=this;if(this.usePkce){var t=this.crypto.generateRandom(128);return this.crypto.deriveChallenge(t).catch(function(e){M.log("Unable to generate PKCE challenge. Not using PKCE",e)}).then(function(n){n&&(e.internal=e.internal||{},e.internal.code_verifier=t,e.extras=e.extras||{},e.extras.code_challenge=n,e.extras.code_challenge_method="S256")})}return Promise.resolve()},e.prototype.toJson=function(){var e=this;return this.setupCodeVerifier().then(function(){return{response_type:e.responseType,client_id:e.clientId,redirect_uri:e.redirectUri,scope:e.scope,state:e.state,extras:e.extras,internal:e.internal}})},e.RESPONSE_TYPE_TOKEN="token",e.RESPONSE_TYPE_CODE="code",e}();t.AuthorizationRequest=n}),H=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequestHandler=t.BUILT_IN_PARAMETERS=t.AuthorizationNotifier=void 0;var n=function(){function e(){this.listener=null}return e.prototype.setAuthorizationListener=function(e){this.listener=e},e.prototype.onAuthorizationComplete=function(e,t,n){this.listener&&this.listener(e,t,n)},e}();t.AuthorizationNotifier=n,t.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var o=function(){function e(e,t){this.utils=e,this.crypto=t,this.notifier=null}return e.prototype.buildRequestUrl=function(e,n){var o={redirect_uri:n.redirectUri,client_id:n.clientId,response_type:n.responseType,state:n.state,scope:n.scope};if(n.extras)for(var r in n.extras)n.extras.hasOwnProperty(r)&&t.BUILT_IN_PARAMETERS.indexOf(r)<0&&(o[r]=n.extras[r]);var i=this.utils.stringify(o);return e.authorizationEndpoint+"?"+i},e.prototype.completeAuthorizationRequestIfPossible=function(){var e=this;return M.log("Checking to see if there is an authorization response to be delivered."),this.notifier||M.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then(function(t){t||M.log("No result is available yet."),t&&e.notifier&&e.notifier.onAuthorizationComplete(t.request,t.response,t.error)})},e.prototype.setAuthorizationNotifier=function(e){return this.notifier=e,this},e}();t.AuthorizationRequestHandler=o}),F=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationError=t.AuthorizationResponse=void 0;var n=function(){function e(e){this.code=e.code,this.state=e.state}return e.prototype.toJson=function(){return{code:this.code,state:this.state}},e}();t.AuthorizationResponse=n;var o=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri,this.state=e.state}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},e}();t.AuthorizationError=o}),G=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BasicQueryStringUtils=void 0;var n=function(){function e(){}return e.prototype.parse=function(e,t){return this.parseQueryString(t?e.hash:e.search)},e.prototype.parseQueryString=function(e){for(var t={},n=(e=e.trim().replace(/^(\?|#|&)/,"")).split("&"),o=0;o<n.length;o+=1){var r=n[o].split("=");if(r.length>=2){var i=decodeURIComponent(r.shift()),s=r.length>0?r.join("="):null;s&&(t[i]=decodeURIComponent(s))}}return t},e.prototype.stringify=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&e[n]&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},e}();t.BasicQueryStringUtils=n}),Z=(0,p.c)(function(e,t){var n,o=p.a&&p.a.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageBackend=t.StorageBackend=void 0;var r=function(){};t.StorageBackend=r;var i=function(e){function t(t){var n=e.call(this)||this;return n.storage=t||window.localStorage,n}return o(t,e),t.prototype.getItem=function(e){var t=this;return new Promise(function(n,o){n(t.storage.getItem(e)||null)})},t.prototype.removeItem=function(e){var t=this;return new Promise(function(n,o){t.storage.removeItem(e),n()})},t.prototype.clear=function(){var e=this;return new Promise(function(t,n){e.storage.clear(),t()})},t.prototype.setItem=function(e,t){var n=this;return new Promise(function(o,r){n.storage.setItem(e,t),o()})},t}(r);t.LocalStorageBackend=i}),J=(0,p.c)(function(e,t){var n,o=p.a&&p.a.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectRequestHandler=void 0;var r=function(e){return e+"_appauth_authorization_request"},i=function(e){return e+"_appauth_authorization_service_configuration"},s="appauth_current_authorization_request",a=function(e){function t(t,n,o,r){void 0===t&&(t=new Z.LocalStorageBackend),void 0===n&&(n=new G.BasicQueryStringUtils),void 0===o&&(o=window.location),void 0===r&&(r=new z.DefaultCrypto);var i=e.call(this,n,r)||this;return i.storageBackend=t,i.locationLike=o,i}return o(t,e),t.prototype.performAuthorizationRequest=function(e,t){var n=this,o=this.crypto.generateRandom(10);Promise.all([this.storageBackend.setItem(s,o),t.toJson().then(function(e){return n.storageBackend.setItem(r(o),JSON.stringify(e))}),this.storageBackend.setItem(i(o),JSON.stringify(e.toJson()))]).then(function(){var o=n.buildRequestUrl(e,t);M.log("Making a request to ",t,o),n.locationLike.assign(o)})},t.prototype.completeAuthorizationRequest=function(){var e=this;return this.storageBackend.getItem(s).then(function(t){return t?e.storageBackend.getItem(r(t)).then(function(e){return JSON.parse(e)}).then(function(e){return new B.AuthorizationRequest(e)}).then(function(n){var o=""+e.locationLike.origin+e.locationLike.pathname,a=e.utils.parse(e.locationLike,!0),c=a.state,u=a.code,h=a.error;M.log("Potential authorization request ",o,a,c,u,h);var l=null,d=null;return c===n.state?(h?d=new F.AuthorizationError({error:h,error_description:a.error_description,error_uri:a.error_uri,state:c}):l=new F.AuthorizationResponse({code:u,state:c}),Promise.all([e.storageBackend.removeItem(s),e.storageBackend.removeItem(r(t)),e.storageBackend.removeItem(i(t))]).then(function(){return M.log("Delivering authorization response"),{request:n,response:l,error:d}})):(M.log("Mismatched request (state and request_uri) dont match."),Promise.resolve(null))}):null})},t}(H.AuthorizationRequestHandler);t.RedirectRequestHandler=a}),V=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=t.TokenResponse=t.nowInSeconds=void 0,t.nowInSeconds=function(){return Math.round((new Date).getTime()/1e3)};var n=function(){function e(e){this.accessToken=e.access_token,this.tokenType=e.token_type||"bearer",e.expires_in&&(this.expiresIn=parseInt(e.expires_in,10)),this.refreshToken=e.refresh_token,this.scope=e.scope,this.idToken=e.id_token,this.issuedAt=e.issued_at||t.nowInSeconds()}return e.prototype.toJson=function(){var e;return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:null===(e=this.expiresIn)||void 0===e?void 0:e.toString()}},e.prototype.isValid=function(e){return void 0===e&&(e=-600),!this.expiresIn||t.nowInSeconds()<this.issuedAt+this.expiresIn+e},e}();t.TokenResponse=n;var o=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e}();t.TokenError=o}),Y=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTokenRequestHandler=void 0;var n=function(){function e(e,t){void 0===e&&(e=new L.JQueryRequestor),void 0===t&&(t=new G.BasicQueryStringUtils),this.requestor=e,this.utils=t}return e.prototype.isTokenResponse=function(e){return void 0===e.error},e.prototype.performRevokeTokenRequest=function(e,t){return this.requestor.xhr({url:e.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then(function(e){return!0})},e.prototype.performTokenRequest=function(e,t){var n=this;return this.requestor.xhr({url:e.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then(function(e){return n.isTokenResponse(e)?new V.TokenResponse(e):Promise.reject(new C.AppAuthError(e.error,new V.TokenError(e)))})},e}();t.BaseTokenRequestHandler=n}),Q=(0,p.c)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequest=t.GRANT_TYPE_REFRESH_TOKEN=t.GRANT_TYPE_AUTHORIZATION_CODE=void 0,t.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",t.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var n=function(){function e(e){this.clientId=e.client_id,this.redirectUri=e.redirect_uri,this.grantType=e.grant_type,this.code=e.code,this.refreshToken=e.refresh_token,this.extras=e.extras}return e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var e={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(e.code=this.code),this.refreshToken&&(e.refresh_token=this.refreshToken),this.extras)for(var t in this.extras)this.extras.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.extras[t]);return e},e}();t.TokenRequest=n});class K extends G.BasicQueryStringUtils{constructor(e,t,n){super(),this.code=e,this.state=t,this.error=n}parse(e,t){return{code:this.code,state:this.state,error:this.error}}}class W{constructor(){this.config=null,this.fetchRequestor=new L.FetchRequestor,this.tokenHandler=new Y.BaseTokenRequestHandler(this.fetchRequestor)}recieveMessage({data:{state:e,error:t,code:n}}){var r=this;return(0,o.Z)(function*(){if((0,c.d)("silent_auth","Received message event"),null!=r.authorizationHandler){if((0,a.i)(n)&&(0,a.i)(e)){const{LOGIN_REDIRECT_URL:t,CLIENT_ID:i}=r.config||{};if(!(0,a.i)(i))throw new Error("config was not set on silent auth service");let s,u;r.authorizationHandler.locationLike=f.w.location,r.authorizationHandler.utils=new K(n,e,null);try{s=yield r.authorizationHandler.completeAuthorizationRequest()}catch(o){throw(0,c.e)("silent_auth",`Complete authorization request failed: ${JSON.stringify(o.message)}`),o}(0,c.d)("silent_auth","Authorization Request Response received. Trying to get token...");try{const e=new Q.TokenRequest({client_id:i,redirect_uri:t,grant_type:Q.GRANT_TYPE_AUTHORIZATION_CODE,code:s.response.code,refresh_token:void 0,extras:{prompt:"none",code_verifier:s.request.internal.code_verifier}});u=yield r.tokenHandler.performTokenRequest(r.authorizationServiceConfiguration,e)}catch(o){throw(0,c.e)("silent_auth",`Token request failed: ${JSON.stringify(o.message)}`),o}if((0,c.d)("silent_auth","Token request completed successfully"),(0,a.i)(u.accessToken))return u.accessToken;const h="Token request failed: access token not present in response";throw(0,c.e)("silent_auth",h),new Error(h)}if((0,a.i)(t)){const e=`Received error from message, ${t}`;throw(0,c.e)("silent_auth",e),new Error(e)}}else(0,c.d)("silent_auth","Received message event but authorizationHandler not initialised")})()}setConfig(e){var t=this;return(0,o.Z)(function*(){t.config=e;const{LOGIN_BASE_URL:n}=t.config||{};(0,a.i)(n)&&(t.authorizationServiceConfiguration=yield b.AuthorizationServiceConfiguration.fetchFromIssuer(n,t.fetchRequestor))})()}fetchAccessToken(){const{CLIENT_ID:e,LOGIN_REDIRECT_URL:t}=this.config||{};if(!(0,a.i)(e)||!(0,a.i)(t))throw new Error("Config has not been set.");if(void 0===this.authorizationServiceConfiguration)throw new Error("oauth config has not been fetched.");if(void 0===this.locationLike&&(this.locationLike=f.w.getIframeLocationLike("auth-iframe-navigation-header")),"function"!=typeof this.locationLike.assign)throw new Error("unable to perform authorization request due to incompatible locationLike");const n=new Z.LocalStorageBackend(f.w.sessionStorage);if("function"!=typeof n.setItem)throw new Error("invalid storage backend provided");this.authorizationHandler=new J.RedirectRequestHandler(n,new K(null,null,null),this.locationLike,{generateRandom:f.w.generateRandom,deriveChallenge:f.w.deriveChallenge});const o=new B.AuthorizationRequest({client_id:e,redirect_uri:t,scope:"openid",response_type:B.AuthorizationRequest.RESPONSE_TYPE_CODE,state:void 0,extras:{prompt:"none"}},{generateRandom:f.w.generateRandom,deriveChallenge:f.w.deriveChallenge});this.authorizationHandler.performAuthorizationRequest(this.authorizationServiceConfiguration,o)}}class X{constructor(e){this.config=null,this.isPorscheCom=!1,this.silentAuthService=null,this.initialisingSilentAuthService=!1,this.locale=e}static getUserNameFromUserData(e={}){let t="";return(0,a.i)(e.firstName)?(t=e.firstName,(0,a.i)(e.middleName)?(t+=` ${e.middleName}`,(0,a.i)(e.lastName)&&(t+=` ${e.lastName}`)):(0,a.i)(e.lastName)&&(t+=` ${e.lastName}`)):(0,a.i)(e.middleName)?(t=e.middleName,(0,a.i)(e.lastName)&&(t+=` ${e.lastName}`)):(0,a.i)(e.lastName)&&(t=e.lastName),t}static getUserIdFromUserData(e={}){return(0,o.Z)(function*(){return yield f.w.hashString(e.porscheId)})()}setConfig(e){var t=this;return(0,o.Z)(function*(){if("object"==typeof e&&null!==e){if(t.config=e,t.isPorscheCom=t.config.PORSCHE_COM_URL.some(e=>e.includes(f.w.location.origin)),null!==t.silentAuthService)try{yield t.silentAuthService.setConfig(t.config)}catch(n){(0,c.e)("user_service_set_config",`Could not set silent auth config: ${n}`),yield t.silentAuthService.setConfig(null)}}else t.config=null,t.isPorscheCom=!1})()}getUserData(e){var t=this;return(0,o.Z)(function*(){let n;const o={method:"GET",headers:{"Accept-Language":`${t.locale.toHeaderString()}`,"x-trace-id":A(),apikey:t.config.CLIENT_ID,Authorization:`Bearer ${e}`,Accept:"application/json"}},r=void 0===t.locale.country?"":`?country=${t.locale.country}`;try{n=yield fetch(`${t.config.PROFILE_API_URL}${r}`,o)}catch(i){const e=`Exception occurred while fetching user info: ${JSON.stringify(i.message)}`;throw(0,c.e)("user_profile",e),new Error(e)}if(200!==n.status){const e=`Error occurred: ${n.status} ${n.statusText}`;throw(0,c.e)("user_profile",e),new Error(e)}return n.json()})()}getUnreadMessagesCount(e){var t=this;return(0,o.Z)(function*(){var n;const o={method:"GET",headers:{"x-trace-id":A(),apikey:t.config.CLIENT_ID,Authorization:`Bearer ${e}`,Accept:"application/json"}};let r;try{r=yield fetch(t.config.UNREAD_MESSAGES_COUNT_API_URL,o)}catch(i){const e=`Exception occurred while fetching unread message count: ${JSON.stringify(i.message)}`;(0,c.e)("unread_messages_count",e)}if(200===r.status){const e=yield r.json();if("number"==typeof(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.unreadCount))return e.data.unreadCount}else(0,c.e)("unread_messages_count",`Error occurred: ${r.status} ${r.statusText}`);return 0})()}newMessageEventReceived(e,t){var n=this;return(0,o.Z)(function*(){if(null===n.silentAuthService)return(0,c.i)("user_service","auth message received but silent auth service not initialised - venting"),t;let o;try{o=yield n.silentAuthService.recieveMessage(e)}catch(r){return void(d.n.state.loggedInState=a.L)}return(0,a.i)(o)?n.accessTokenUpdated(o,t,!0):t})()}accessTokenUpdated(e,t,n){var r=this;return(0,o.Z)(function*(){if(e===a.R)return t;if(null===r.config)return e;d.n.state.loggedInState=a.a;let o,i=0,s=a.L;if((0,a.i)(e)){try{const t=yield r.getUserData(e);s=X.getUserNameFromUserData(t)||a.b,o=yield X.getUserIdFromUserData(t)}catch(u){throw d.n.state.unreadMessagesCount=i,d.n.state.loggedInState=s,u}try{i=yield r.getUnreadMessagesCount(e)}catch(u){}return d.n.state.unreadMessagesCount=i,d.n.state.loggedInState=s,l.a.state.userId=o,e}if(!r.isPorscheCom||!n)return d.n.state.unreadMessagesCount=i,void(d.n.state.loggedInState=s);if(!r.initialisingSilentAuthService)try{null===r.silentAuthService&&(r.initialisingSilentAuthService=!0,r.silentAuthService=new W,yield r.silentAuthService.setConfig(r.config),r.initialisingSilentAuthService=!1),r.silentAuthService.fetchAccessToken()}catch(u){(0,c.e)("user_service",`could not init silent auth service: ${u}`),d.n.state.unreadMessagesCount=i,d.n.state.loggedInState=s}})()}revokeAccessToken(e){var t=this;return(0,o.Z)(function*(){if(null===t.config||!(0,a.i)(e))return;const{LOGIN_BASE_URL:n,CLIENT_ID:o}=t.config;let r;try{r=yield fetch(`${n}/as/revoke_token.oauth2`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`token=${encodeURIComponent(e)}&client_id=${encodeURIComponent(o)}`})}catch(i){const e=`Exception occurred while revoking access token: ${JSON.stringify(i.message)}`;throw(0,c.e)("revoke_access_token",e),i}if(!r.ok)throw(0,c.e)("revoke_access_token",401===r.status?"Unauthorized revocation attempt":"Error when revoking acccess token"),new Error("Revoke access token failed")})()}}let ee=class{constructor(e){(0,r.r)(this,e),this.accessTokenExpired=(0,r.c)(this,"accessTokenExpired",7),this.navigationDidLoad=(0,r.c)(this,"navigationDidLoad",7),this.phnLogout=(0,r.c)(this,"phnLogout",6),this.config=null,this.accessibilityStatement=a.c,this.countryRecommenderContent=a.d,this.scrolledPastHeader=!1,this.breakpoint=f.w.getBreakpoint(),this.showCountryRecommender=f.w.redirected,this.countryRecommenderClosed=!1,this.menuDrawerClosed=!0,this.localeObject=new s.L,this.userService=new X(this.localeObject)}localeWatchHandler(){var e=this;return(0,o.Z)(function*(){e.localeObject.setLocale(e.locale),l.a.state.locale.setLocale(e.locale),yield e.initNavContentStore()})()}newAccessTokenReceived(){var e=this;return(0,o.Z)(function*(){e.accessToken!==a.R&&(e.accessToken!==e.accessTokenState&&(yield e.accessTokenStateUpdated(e.accessToken)),e.accessToken=a.R)})()}newEnvReceived(){var e=this;return(0,o.Z)(function*(){yield e.initEnvironment(),yield e.initNavContentStore(),yield e.accessTokenStateUpdated(e.accessTokenState)})()}scrollHandler(){this.scrolledPastHeader=this.el.getBoundingClientRect().bottom<=0}newAuthMessageReceived(e){var t=this;return(0,o.Z)(function*(){const{LOGIN_REDIRECT_URL:n}=t.config||{};(0,a.i)(n)&&n.startsWith(e.origin)&&(t.accessTokenState=yield t.userService.newMessageEventReceived(e,t.accessTokenState))})()}handleLogout(e){var t=this;return(0,o.Z)(function*(){try{yield t.userService.revokeAccessToken(t.accessTokenState)}catch(n){return}t.phnLogout.emit(),f.w.location=e.detail})()}resizeHandler(){this.breakpoint=f.w.getBreakpoint()}accessTokenStateUpdated(e){var t=this;return(0,o.Z)(function*(){const n=g.n.state.metafunctionalities.length>1;try{t.accessTokenState=yield t.userService.accessTokenUpdated(e,t.accessTokenState,n)}catch(o){t.accessTokenExpired.emit(),t.accessTokenState=void 0}})()}initEnvironment(){var e=this;return(0,o.Z)(function*(){const t=Object.keys(v);(0,a.i)(e.env)&&t.includes(e.env)?(e.config=v[e.env],h.f.setFeatures(e.env),yield e.userService.setConfig(e.config),l.a.set("environment",e.env)):e.env=a.e})()}initNavContentStore(){var e=this;return(0,o.Z)(function*(){if(""===e.localeObject.toString()||null===e.config)return;let t;try{t=yield m(e.config.CONTENT_URL,e.localeObject)}catch(n){return void(e.locale=e.localeObject.setLocale().toString())}Object.keys(t).forEach(e=>{g.n.set(e,t[e])}),h.f.isFeatureEnabled(a.F,f.w.location.search)&&g.n.set("dealer",h.m),e.accessibilityStatement=g.n.state.accessibilityStatement,e.countryRecommenderContent=g.n.state.countryRecommender,(0,a.i)(e.clientId)&&(d.n.state.applicationClientId=e.clientId)})()}componentWillLoad(){var e=this;return(0,o.Z)(function*(){e.el.style.setProperty("--scrollbar-width",f.w.getScrollbarWidth()),(0,a.i)(e.locale)&&(e.localeObject.setLocale(e.locale),l.a.state.locale.setLocale(e.locale)),yield e.initEnvironment(),yield e.initNavContentStore(),(0,a.i)(e.accessToken)&&e.accessToken!==a.R&&(e.accessTokenState=e.accessToken,e.accessToken=a.R)})()}componentDidLoad(){var e=this;return(0,o.Z)(function*(){const t=new _(l.a.state);(l.a.state.w.pagData=l.a.state.w.pagData||[]).push(t.event()),d.n.state.navigationLoaded?(f.w.navigationLoaded=!0,e.navigationDidLoad.emit()):d.n.onChange("navigationLoaded",()=>{f.w.navigationLoaded=!0,e.navigationDidLoad.emit()}),f.w.version=a.V,yield e.accessTokenStateUpdated(e.accessTokenState)})()}skipToMainContent(e){e.stopPropagation();const t=this.el.shadowRoot.querySelector("#main");t.tabIndex=0,t.focus()}mainContentTab(){this.el.shadowRoot.querySelector("#main").tabIndex=-1}addFocus(){const e=this.el.shadowRoot.querySelector("phn-p-button.skip-content");e.classList.add("focused");const t=this.el.shadowRoot.querySelector("phn-crest phn-p-marque");e.style.left=`${t.getBoundingClientRect().left}px`}removeFocus(){const e=this.el.shadowRoot.querySelector("phn-p-button.skip-content");e.classList.remove("focused"),e.style.left=""}render(){const{ASSETS_URL:e="",COUNTRY_SELECTOR_URL:t="",FOOTER_ASSETS_URL:n="",LOGIN_BASE_URL:o="",DEALER_API_URL:s=""}=this.config||{};return(0,a.i)(d.n.state.loggedInState)&&(l.a.state.loginStatus=(0,a.g)(d.n.state.loggedInState)),(0,r.h)(r.H,null,this.showCountryRecommender&&null!==this.countryRecommenderContent&&!this.countryRecommenderClosed?(0,r.h)("phn-country-recommender",{locale:this.localeObject,content:this.countryRecommenderContent,assetsURL:n,countrySelectorURL:t,env:this.env,role:"region","aria-label":"Change recommended Region or Language",onBannerClosed:()=>{this.countryRecommenderClosed=!0}}):null,"en-US"===this.locale&&null!==this.accessibilityStatement?(0,r.h)("a",{class:"sr-only",href:this.accessibilityStatement.Link},this.accessibilityStatement.Text):null,(0,r.h)("phn-p-button",{variant:"primary",class:"skip-content",onFocus:()=>this.addFocus(),onClick:e=>this.skipToMainContent(e),onBlur:()=>this.removeFocus()},"Skip to main content"),(0,r.h)("header",null,(0,r.h)("phn-p-flex",{class:"header-content","justify-content":"space-between"},(0,r.h)("phn-crest",{breakpoint:this.breakpoint}),this.breakpoint<i.b.l?(0,r.h)("phn-burger-button",{onClick:e=>{this.usingKeyboard=(0,a.f)(e),this.menuDrawerClosed=!this.menuDrawerClosed}}):(0,r.h)("phn-menu-desktop-level-1",{assetsURL:e,loginURL:o,breakpoint:this.breakpoint})),this.breakpoint<i.b.l&&!this.menuDrawerClosed?(0,r.h)("phn-menu-drawer",{assetsURL:e,loginURL:o,breakpoint:this.breakpoint,initialUsingKeyboard:this.usingKeyboard,dealerApiUrl:s,onDrawerClosed:({detail:{usingKeyboard:e}})=>{var t;this.menuDrawerClosed=!0,this.usingKeyboard=e,e&&(null===(t=(0,a.h)(this.el.shadowRoot.querySelector("phn-burger-button phn-p-button-pure")))||void 0===t||t.focus())}}):null),(0,r.h)("div",{class:"header-border"}),"preview"===this.env?(0,r.h)("phn-preview-badge",{versionString:`Header ${a.V} - PP content`}):null,(0,r.h)("div",{id:"main",tabindex:"-1",class:"main-content",onBlur:()=>this.mainContentTab()}))}static get assetsDirs(){return["auth"]}get el(){return(0,r.g)(this)}static get watchers(){return{locale:["localeWatchHandler"],accessToken:["newAccessTokenReceived"],env:["newEnvReceived"]}}};ee.style='@-webkit-keyframes slideDown{from{max-height:0}to{max-height:1000px}}@keyframes slideDown{from{max-height:0}to{max-height:1000px}}@-webkit-keyframes slideUp{from{max-height:1000px}to{max-height:0}}@keyframes slideUp{from{max-height:1000px}to{max-height:0}}@-webkit-keyframes slideLeft{from{max-width:0}to{max-width:1000px}}@keyframes slideLeft{from{max-width:0}to{max-width:1000px}}@-webkit-keyframes slideRight{from{max-width:1000px}to{max-width:0}}@keyframes slideRight{from{max-width:1000px}to{max-width:0}}@-webkit-keyframes darken{from{background-color:rgba(0, 0, 0, 0)}to{background-color:rgba(0, 0, 0, 0.8)}}@keyframes darken{from{background-color:rgba(0, 0, 0, 0)}to{background-color:rgba(0, 0, 0, 0.8)}}@-webkit-keyframes lighten{from{background-color:rgba(0, 0, 0, 0.8)}to{background-color:rgba(0, 0, 0, 0)}}@keyframes lighten{from{background-color:rgba(0, 0, 0, 0.8)}to{background-color:rgba(0, 0, 0, 0)}}@-webkit-keyframes fadeIn{0%{opacity:0;top:36px}100%{opacity:1;top:0px}}@keyframes fadeIn{0%{opacity:0;top:36px}100%{opacity:1;top:0px}}:host{display:block;position:relative;background-color:#fff;visibility:visible;height:auto !important}:host header{font-family:"Porsche Next", "Arial Narrow", Arial, "Heiti SC", SimHei, sans-serif;font-weight:400;height:3.8125rem;color:#000;-webkit-box-sizing:content-box;box-sizing:content-box;margin:0 7vw}@media (min-width: 1000px){:host header{padding-left:var(--scrollbar-width)}}@media (min-width: 1760px){:host header{margin:0 10vw}}@media (min-width: 1920px){:host header{margin:0 auto;width:96rem}}@media (min-width: 760px){:host header{height:4.4375rem}}@media (min-width: 1300px){:host header{height:7.3125rem;-ms-flex-direction:row;flex-direction:row}}@media (min-width: 1760px){:host header{height:7.6875rem}}:host header .header-content{height:100%}:host header phn-crest{z-index:1;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}@media (min-width: 1300px){:host header phn-crest{z-index:400}}:host header .burger-button:focus{outline-width:2px;outline-style:solid;outline-offset:1px;outline-color:currentColor}:host .header-border{height:1px;background-color:#e3e4e5}:host phn-p-button.skip-content{display:none}@media (min-width: 1000px){:host phn-p-button.skip-content{display:-ms-inline-flexbox;display:inline-flex;left:-999px;position:absolute;width:auto;height:auto;overflow:hidden;z-index:-999}}:host phn-p-button.skip-content.focused{outline-width:2px;outline-style:solid;outline-offset:1px;outline-color:currentColor;overflow:visible;z-index:999}:host .main-content{width:20px}:host .main-content:focus{outline-style:none}:host .sr-only{position:absolute;width:1px;height:1px;white-space:nowrap;overflow:hidden;clip:rect(1px, 1px, 1px, 1px);-webkit-clip-path:inset(50%);clip-path:inset(50%)}'}}]);